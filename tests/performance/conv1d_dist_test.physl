#!/usr/bin/env physl
define(conv, batch, length, channel, out_channel, filter_length,
    block(
        define(array,
            random_d(list(batch, length, channel), nil, nil, "", "page")),
        define(kernel,
           random(list(out_channel, channel, filter_length))),
        timer(
           define(out, conv1d_d(array, kernel)),
            lambda(time, cout("locality", find_here(), ":", time))
        )

        //cout(shape(out))
    )
)
apply(conv, sys_argv)
